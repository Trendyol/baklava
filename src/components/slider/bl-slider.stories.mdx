import { Meta, Canvas, ArgsTable, Story } from '@storybook/addon-docs';
import { html } from 'lit';
import { ifDefined } from 'lit/directives/if-defined.js';
import { extraPadding } from '../../utilities/chromatic-decorators';

<Meta
  title="Components/Slider"
  component="bl-slider"
  decorators={[
    extraPadding,
  ]}
  argTypes={{
    label: {
      control: 'text',
    },
    value: {
      control: 'text',
    },
    min: {
      control: 'text',
    },
    max: {
      control: 'text',
    },
    step: {
      control: 'text',
    },
    helpText: {
      control: 'text',
    },
    disabled: {
      control: 'boolean',
    },
    tooltip: {
      control: 'boolean',
    },
    marks: {
      control: 'text',
    },
    showMinMax: {
      control: 'boolean',
    },
  }}
/>

export const SliderTemplate = (args) => html`
  <bl-slider
    label=${ifDefined(args.label)}
    value=${ifDefined(args.value)}
    min=${ifDefined(args.min)}
    max=${ifDefined(args.max)}
    step=${ifDefined(args.step)}
    help-text=${ifDefined(args.helpText)}
    ?disabled=${args.disabled}
    ?tooltip=${args.tooltip}
    ?show-min-max=${args.showMinMax}
    marks=${ifDefined(args.marks)}
  ></bl-slider>
`;

export const SliderWithValue = (args) => html`
  <div>
    <bl-slider
      label=${ifDefined(args.label)}
      value=${ifDefined(args.value)}
      min=${ifDefined(args.min)}
      max=${ifDefined(args.max)}
      step=${ifDefined(args.step)}
      help-text=${ifDefined(args.helpText)}
      ?disabled=${args.disabled}
      ?tooltip=${args.tooltip}
      ?show-min-max=${args.showMinMax}
      marks=${ifDefined(args.marks)}
      @bl-slider-change=${(e) => {
        const valueDisplay = e.target.parentElement.querySelector('.value-display');
        if (valueDisplay) {
          valueDisplay.textContent = `Value: ${e.detail.value}`;
        }
      }}
    ></bl-slider>
    <div class="value-display" style="margin-top: 16px; font: var(--bl-font-title-4-medium); color: var(--bl-color-primary);">
      Value: ${args.value || '0'}
    </div>
  </div>
`;

# Slider

<bl-badge icon="document">[ADR](https://github.com/Trendyol/baklava/issues/683)</bl-badge>
<bl-badge icon="puzzle">[Figma](https://www.figma.com/design/lSvX6Qe0jc8b4CaIK7egXR/Baklava-Component-Library?node-id=22837-9405&t=a6b6d96GJX7NqtZE-0)</bl-badge>

Slider component allows users to select a numeric value from a range by moving a thumb along a track.

## Basic Usage

Sliders are used for adjusting values like number, amount, price, etc. intervals visually.
You can adapt and use them with different options such as labels, text, numbers, and tooltips.

<Canvas>
  <Story name="Basic Usage" args={{ label: 'Label', value: '75' }}>
    {SliderWithValue.bind({})}
  </Story>
</Canvas>

## With Label

This slider includes a label to describe its purpose. Use it when you need to clearly indicate what the slider controls.

<Canvas>
  <Story name="With Label" args={{ label: 'Label', value: '75' }}>
    {SliderWithValue.bind({})}
  </Story>
</Canvas>

## With Helper Text

This slider comes with a helper text to provide additional information. Use it to explain units, ranges, or any specific details users should know.

<Canvas>
  <Story name="With Helper Text" args={{
    label: 'Label',
    helpText: 'Helper Text',
    value: '75'
  }}>
    {SliderWithValue.bind({})}
  </Story>
</Canvas>

## With Marks (Discrete Slider)

This slider moves in fixed steps instead of a smooth range. Use it when users should select predefined values rather than free input.

<Canvas>
  <Story name="With Marks" args={{
    label: 'Label',
    value: '50',
    step: '25',
    marks: JSON.stringify([
      { value: 0, label: '' },
      { value: 25, label: '' },
      { value: 50, label: '50' },
      { value: 75, label: '' },
      { value: 100, label: '' }
    ])
  }}>
    {SliderWithValue.bind({})}
  </Story>
</Canvas>

## With Tooltip

This slider displays a tooltip showing the selected value while adjusting. Use it when users need real-time feedback on their selection.

<Canvas>
  <Story name="With Tooltip" args={{
    label: 'Label',
    tooltip: true,
    value: '60'
  }}>
    {SliderWithValue.bind({})}
  </Story>
</Canvas>

## With Custom Min/Max Values

Slider with custom range values. The slider value is always constrained between the min and max values. You can adjust min and max values using the inputs below to test the behavior.

<Canvas>
  <Story name="Custom Range">
    {() => {
      const minInput = (e) => {
        const container = e.target.closest('div').parentElement;
        const slider = container.querySelector('bl-slider');
        const valueDisplay = container.querySelector('.value-display');
        if (slider) {
          const newMin = parseFloat(e.target.value);
          const currentValue = parseFloat(slider.value);
          slider.min = e.target.value;

          // Value'yu yeni min'e göre constrain et
          if (currentValue < newMin) {
            slider.value = String(newMin);
          }

          // UI'ı güncelle
          slider.requestUpdate();
          if (valueDisplay) {
            valueDisplay.textContent = `Value: ${slider.value} (Min: ${slider.min}, Max: ${slider.max})`;
          }
        }
      };
      const maxInput = (e) => {
        const container = e.target.closest('div').parentElement;
        const slider = container.querySelector('bl-slider');
        const valueDisplay = container.querySelector('.value-display');
        if (slider) {
          const newMax = parseFloat(e.target.value);
          const currentValue = parseFloat(slider.value);
          slider.max = e.target.value;

          // Value'yu yeni max'a göre constrain et
          if (currentValue > newMax) {
            slider.value = String(newMax);
          }

          // UI'ı güncelle
          slider.requestUpdate();
          if (valueDisplay) {
            valueDisplay.textContent = `Value: ${slider.value} (Min: ${slider.min}, Max: ${slider.max})`;
          }
        }
      };
      const sliderChange = (e) => {
        const valueDisplay = e.target.parentElement.querySelector('.value-display');
        if (valueDisplay) {
          valueDisplay.textContent = `Value: ${e.detail.value} (Min: ${e.target.min}, Max: ${e.target.max})`;
        }
      };
      return html`
        <div style="display: flex; flex-direction: column; gap: 16px;">
          <div style="display: flex; gap: 16px; align-items: center;">
            <label style="font: var(--bl-font-body-text-2);">
              Min Value:
              <input
                type="number"
                value="-20"
                @input=${minInput}
                style="margin-left: 8px; padding: 4px 8px; border: 1px solid var(--bl-color-neutral-light); border-radius: 4px; width: 80px;"
              />
            </label>
            <label style="font: var(--bl-font-body-text-2);">
              Max Value:
              <input
                type="number"
                value="40"
                @input=${maxInput}
                style="margin-left: 8px; padding: 4px 8px; border: 1px solid var(--bl-color-neutral-light); border-radius: 4px; width: 80px;"
              />
            </label>
          </div>
          <bl-slider
            label="Temperature"
            min="-20"
            max="40"
            value="22"
            show-min-max
            @bl-slider-change=${sliderChange}
          ></bl-slider>
          <div class="value-display" style="font: var(--bl-font-title-4-medium); color: var(--bl-color-primary);">
            Value: 22 (Min: -20, Max: 40)
          </div>
        </div>
      `;
    }}
  </Story>
</Canvas>

## With Decimal Step

Slider with decimal step values for precise control.

<Canvas>
  <Story name="Decimal Step" args={{
    label: 'Label',
    min: '0.5',
    max: '2',
    step: '0.1',
    value: '1.0',
    tooltip: true
  }}>
    {SliderWithValue.bind({})}
  </Story>
</Canvas>

## Disabled State

Slider in disabled state cannot be interacted with.

<Canvas>
  <Story name="Disabled" args={{
    label: 'Volume',
    value: '50',
    disabled: true
  }}>
    {SliderTemplate.bind({})}
  </Story>
</Canvas>

## All Variants

<Canvas>
  <Story name="All Variants">
    {() => html`
      <div style="display: flex; flex-direction: column; gap: 32px;">
        <bl-slider label="Basic Slider" value="50"></bl-slider>

        <bl-slider
          label="With Tooltip"
          tooltip
          value="75"
        ></bl-slider>

        <bl-slider
          label="With Marks"
          value="50"
          step="25"
          marks=${JSON.stringify([
            { value: 0, label: '0' },
            { value: 50, label: '50' },
            { value: 100, label: '100' }
          ])}
        ></bl-slider>

        <bl-slider
          label="Custom Range (-20 to 40)"
          min="-20"
          max="40"
          value="10"
        ></bl-slider>

        <bl-slider
          label="Disabled"
          value="30"
          disabled
        ></bl-slider>

        <bl-slider
          label="With Help Text"
          help-text="Drag to adjust the value"
          value="60"
        ></bl-slider>
      </div>
    `}
  </Story>
</Canvas>

## Events

The `bl-slider-change` event is fired when the slider value changes through user interaction.

<Canvas>
  <Story name="With Event Handler">
    {() => {
      const handleSliderChange = (event) => {
        // Handle slider value change
        // event.detail.value contains the new value
      };

      return html`
        <bl-slider
          label="Brightness"
          value="75"
          @bl-slider-change=${handleSliderChange}
        ></bl-slider>
      `;
    }}
  </Story>
</Canvas>

## CSS Custom Properties

You can customize the slider appearance using CSS custom properties:

- `--bl-slider-color`: Color of the active track & thumb (default: `--bl-color-primary`)
- `--bl-slider-track-color`: Color of the inactive track (default: `--bl-color-neutral-lightest`)

<Canvas>
  <Story name="Custom Colors">
    {() => html`
      <div style="display: flex; flex-direction: column; gap: 32px;">
        <bl-slider
          label="Red Slider"
          value="50"
          style="--bl-slider-color: #ff0000; --bl-slider-track-color: #ffcccc;"
        ></bl-slider>

        <bl-slider
          label="Green Slider"
          value="75"
          style="--bl-slider-color: #00aa00; --bl-slider-track-color: #ccffcc;"
        ></bl-slider>

        <bl-slider
          label="Blue Slider"
          value="30"
          style="--bl-slider-color: #0066ff; --bl-slider-track-color: #cce0ff;"
        ></bl-slider>
      </div>
    `}
  </Story>
</Canvas>

## API Reference

<ArgsTable of="bl-slider" />

